/*! Copyright Weeblr llc 2016 - Licence: http://www.gnu.org/copyleft/gpl.html GNU/GPL */
!function(e,t,a,o){"use strict";function n(e){try{if(!T[e])throw"Unknow tag type "+e;T[e](),shlBootstrap.closeModal()}catch(t){console.debug(t),c("Internal error, unable to insert tag: "+t)}}function r(e){e=e&&e.trim();var t=parseInt(e);return isNaN(t)?0:t}function i(e){e&&jInsertEditorText(e,f)}function m(e,t){if(e){var a=wbampEditorPluginGetContent();t&&(a=a.replace(t,"")),a=e+a,wbampEditorPluginSetContent(a)}}function p(e){var t=o("#wbamp-editor-tab-"+e);if(t.length){if(j){var a=o("#wbamp-editor-tab-"+j);a.length&&a.removeClass("current").addClass("hide")}wbAmpEditorUpdateFooterButton(e);var n=o("#wbamp-option-select");n.val(e),n.trigger("liszt:updated"),j=e,t.removeClass("hide").addClass("current"),x&&(x=!1,s())}}function d(e,t,a,n){n&&n.preventDefault(),f=e,o(t).on("shown",function(){wbAmpEditorUpdateFooterButton(a),v=null,j=j||a,p(j)}).modal()}function c(e){_=_||o(".wbamp-editor-msg-area");var t=o('<div class="alert alert-error" id="wbamp-editor-msg-content">'+e+"</div>");t.prependTo(_),setTimeout(function(){jQuery("#wbamp-editor-msg-content").slideUp(300)},12e3)}function s(){v=v||o("#wbamp-editor-help-button");var e=v.attr("data-helpid");if(x)return void h();if(I[e])b(e,I[e]);else{var t=C+y+"/"+E+"/"+e;u(),jQuery.ajax({url:t,error:function(t,a,o){l(),console.error("Error fetching documentation page "+e),console.error(a)},success:function(t,a,o){b(e,t),l()}})}}function u(){g=g||o(".wbamp-help-frame-loader-container"),g.show(),weeblrApp.spinner.start("wbamp-editor-help-spinner")}function l(){g=g||o(".wbamp-help-frame-loader-container"),weeblrApp.spinner.stop("wbamp-editor-help-spinner"),g.hide()}function w(){x=!0,o("#wbamp-help-frame").fadeIn(),v=v||o("#wbamp-editor-help-button"),v.addClass("displayed")}function h(){x=!1,o("#wbamp-help-frame").slideUp(),v=v||o("#wbamp-editor-help-button"),v.removeClass("displayed")}function b(e,t){t&&!I[e]&&(I[e]=t);var o,n=a.getElementById("wbamp-help-frame");n.document?o=n.document:n.contentWindow&&(o=n.contentWindow.document),o.open(),o.writeln(t),o.close(),w()}var _,f,v,g,y="products.wbamp",E="1",C="https://weeblr.com/index.php?option=com_wbdoc&product="+y+"&version="+E+"&view=document&tmpl=component&embed=true&Itemid=337&doc_url=",x=!1,I={},j="",T={doctype:function(){var e=o("#wbamp_editor_form_doctype_params_document_type").val();if(e=e&&e.trim()){var t='{wbamp-meta name="doc_type" content="'+e+'"}\n';m(t,new RegExp('\n?{wbamp-meta name="doc_type"[^}]+}'))}},docimage:function(){var e=o("#wbamp_editor_form_docimage_params_page_image_url").val();if(e=e&&e.trim()){var t=r(o("#wbamp_editor_form_docimage_params_page_image_width").val()),a=r(o("#wbamp_editor_form_docimage_params_page_image_height").val()),n='{wbamp-meta name="image" url="'+e+'" width="'+t+'" height="'+a+'"}\n';m(n,new RegExp('{wbamp-meta name="image"[^}]+}\n?'))}},docauthor:function(){var e=o("#wbamp_editor_form_docauthor_params_document_author").val();if(e=e&&e.trim()){var t=o("#wbamp_editor_form_docauthor_params_document_author_type").val();t=t&&t.trim();var a='{wbamp-meta name="author" type="'+t+'" content="'+e+'"}\n';m(a,new RegExp('{wbamp-meta name="author"[^}]+}\n'))}},start_amp_show:function(){T.hideshow("start","show")},end_amp_show:function(){T.hideshow("end","show")},start_amp_hide:function(){T.hideshow("start","hide")},end_amp_hide:function(){T.hideshow("end","hide")},hideshow:function(e,t){var a="{wbamp-"+t+" "+e+"}";i(a)}};return e.wbampeditor={insertTag:n,showTab:p,clickRelay:d,showHelp:s,displayHelp:b},e}(window.wblib=window.wblib||{},window,document,jQuery);
